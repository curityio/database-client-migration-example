<config xmlns="http://tail-f.com/ns/config/1.0">
    <profiles xmlns="https://curity.se/ns/conf/base">
        <profile>
            <id>token-service</id>
            <type xmlns:as="https://curity.se/ns/conf/profile/oauth">as:oauth-service</type>
            <expose-detailed-error-messages/>
            <settings>
                <authorization-server xmlns="https://curity.se/ns/conf/profile/oauth">
                    <client-authentication>
                        <symmetrically-signed-jwt>
                            <signature-algorithm>HS256</signature-algorithm>
                        </symmetrically-signed-jwt>
                        <mutual-tls>
                            <by-proxy>
                                <client-certificate-http-header>x-client-cert</client-certificate-http-header>
                            </by-proxy>
                        </mutual-tls>
                    </client-authentication>
                    <client-capabilities>
                        <assertion>
                            <asymmetrically-signed-jwt>
                                <signature-algorithm>PS256</signature-algorithm>
                            </asymmetrically-signed-jwt>
                        </assertion>
                    </client-capabilities>
                    <client-store>
                        <config-backed>
                            <client>
                                <id>web-mtls-client</id>
                                <mutual-tls-by-proxy>
                                <client-dns-name>test.com</client-dns-name>
                                <trusted-ca>Curity_Self_Signed_Root_CA_for_Mutual_TLS_Testing</trusted-ca>
                                </mutual-tls-by-proxy>
                                <redirect-uris>https://oauth.tools/callback/code</redirect-uris>
                                <user-authentication>
                                </user-authentication>
                                <allowed-origins>https://oauth.tools</allowed-origins>
                                <capabilities>
                                <code>
                                </code>
                                </capabilities>
                                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
                            </client>
                            <client>
                                <id>web-pkce-client</id>
                                <no-authentication>true</no-authentication>
                                <redirect-uris>https://oauth.tools/callback/code</redirect-uris>
                                <user-consent>
                                </user-consent>
                                <proof-key>
                                <require-proof-key>true</require-proof-key>
                                </proof-key>
                                <access-token-ttl>1800</access-token-ttl>
                                <refresh-token-ttl>3600</refresh-token-ttl>
                                <id-token-ttl>3600</id-token-ttl>
                                <scope>openid</scope>
                                <scope>profile</scope>
                                <user-authentication>
                                <allowed-authenticators>username</allowed-authenticators>
                                </user-authentication>
                                <capabilities>
                                <code>
                                </code>
                                </capabilities>
                                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
                                <properties>
                                <property>
                                    <key>property1</key>
                                    <value>value1</value>
                                </property>
                                <property>
                                    <key>property2</key>
                                    <value>value2</value>
                                </property>
                                </properties>
                            </client>
                            <client>
                                <id>haapi-android-client</id>
                                <client-name>Haapi Android Client</client-name>
                                <no-authentication>true</no-authentication>
                                <redirect-uris>app://haapi</redirect-uris>
                                <audience>haapi-client</audience>
                                <scope>address</scope>
                                <scope>email</scope>
                                <scope>openid</scope>
                                <scope>phone</scope>
                                <scope>profile</scope>
                                <capabilities>
                                    <code/>
                                    <haapi/>
                                </capabilities>
                                <attestation>
                                    <android>
                                        <package-name>io.curity.haapidemo</package-name>
                                        <signature-digest>Z2DKEZO2XWFWQnApoRCzhqhIxzODe7BUsArj4Up9oKQ=</signature-digest>
                                        <android-policy>android-dev-policy</android-policy>
                                    </android>
                                </attestation>
                            </client>
                            <client>
                                <id>haapi-ios-client</id>
                                <client-name>Haapi iOS Client</client-name>
                                <no-authentication>true</no-authentication>
                                <redirect-uris>haapi:start</redirect-uris>
                                <user-authentication>
                                </user-authentication>
                                <scope>address</scope>
                                <scope>email</scope>
                                <scope>openid</scope>
                                <scope>phone</scope>
                                <scope>profile</scope>
                                <capabilities>
                                <code/>
                                <haapi/>
                                </capabilities>
                                <attestation>
                                <disable-attestation-validation>true</disable-attestation-validation>
                                <ios>
                                    <app-id>io.curity.cat.ios.client</app-id>
                                    <ios-policy>ios-dev-policy</ios-policy>
                                </ios>
                                </attestation>
                            </client>
                            <client>
                                <id>assertion-client</id>
                                <jwks-uri>
                                    <uri>https://api.example.com/jwks</uri>
                                </jwks-uri>
                                <capabilities>
                                <assertion>
                                    <jwt>
                                    <trust>
                                        <asymmetric-signing-key>default-signature-verification-key</asymmetric-signing-key>
                                    </trust>
                                    </jwt>
                                </assertion>
                                </capabilities>
                            </client>
                            <client>
                                <id>token-exchange-client</id>
                                <symmetric-key>data:text/plain;aes,v:S.YVZ4MUFyam9uZUNqZEc2RQ==.ahPewHM2WXl0QQJdQOtZDg==.c6KdaW3AN795C4x7TI7YGOAEzOu5jwI63e9x9tLEDOSddX_m4aScseO0sCjXUA4ywOYrwEVh7ijsFvxsnbRMT9J-7k6VuBh4CLcZb14CUhY=.J3JpAQ1BDdD5GeLCUKkijzVgSKLcjgkJGVvDzsYH09U=</symmetric-key>
                                <capabilities>
                                <token-exchange/>
                                </capabilities>
                            </client>
                        </config-backed>
                    </client-store>
                </authorization-server>
            </settings>
        </profile>
    </profiles>
    <facilities xmlns="https://curity.se/ns/conf/base">
        <client-attestation>
            <ios-policy xmlns="https://curity.se/ns/conf/client-attestation">
                <id>ios-dev-policy</id>
                <mode>non-production</mode>
            </ios-policy>
            <android-policy xmlns="https://curity.se/ns/conf/client-attestation">
                <id>android-dev-policy</id>
                <verify-boot-state>false</verify-boot-state>
                <minimum-security-level>software</minimum-security-level>
                <override-certificate-chain-validation>
                    <do-not-validate-certificate-chain/>
                </override-certificate-chain-validation>
            </android-policy>
        </client-attestation>
            <crypto>
                <ssl>
                    <client-truststore>
                        <client-certificate>
                            <id>Curity_Self_Signed_Root_CA_for_Mutual_TLS_Testing</id>
                            <size>2048</size>
                            <keystore>data:application/pem;aes,v:S.WnFNS0dnQUxlQ0dWTEhlZg==.X_OJCAfVeech-pJ_V2G6UQ==.c-YSPnoWu5ORy9v8_g2upW76iqbGjx3a0n77ADkg84AtZSwLpjKflKZtbgOg4HWHaXGDY4t3VEsy8Axmq-ztpdkqovXH_-TxhdBNMj1fPq8xz06SL7yy_NvpvT6KYxjGpvuvfvea2A4B8tkGAap8nC6nEBTfJMOfkMTRNrLLRvCN1jy0F42nomjAy_co7DWyFm7tXc-ndV-7b-wcwMRO8ZYbATLTSto4AP6MW4ETdF-_VfmzSKyk5pXjOOejK1tSL5txMGl88aT7g4gh0EKhynhH2X2WGYFKwGws6LWmnK3cOQcSfDuuCGS8xWBYv4WVcABLtFLMP5MjA-JXdDVyd_ErOjouhl6OEJPQ9n3PU1VA261UN0PBWeqsV3XPs9euetETHduANqnayPUUYhv_89QXwKoyIsFKAkFh0U5uqW4pPmVi9vN-h5SkX-8lgG9a70IS577QMvgODlt2I7e3iNSJ2xg4PUtq7u_F9ZGLoSUws3DJ3DlTNA7SlrKzwrD66i5UDgrjKZ5gC9fAqm72g8cutJl06IbfzgNsHUj-R_oXXP_20XAyoa53uGV9kXRfjf847ErP8vXju90vhUNIOYHJrUd3sFsH7T6ad67BPjSKQQ8cJR5qiidbXST3Q4qRhzb2WIsStOXu8uuQfcv_MmC2x1KhI5iKR1eajXVFD-uxPEw43tF01YIu1wKVsFy33KdUzvbO27H-gzcTT3qqJi1y_Tn566tfYfKqWYgFIehy9f4LBKXbVRZJUJZaUKmsFxlQG4Ms9wP8Mv6uG8ouwOh_KO-vmEDniutudDOuLV1sTRUV4EFI7_jEd0jPeB2HCQIIUo1fFaBSZ5JoaBG62ATEaP7pmPUwW40If9yDuR6vp6h-gMhfmTFevmF-sx4P9H1u6uY0cgn8OUOSzhemnDF1fsg61F4K1RJQE545dAdjRcTUvWURyToKj2XAsZjtSbvu11RH7O_e4MrDPV9y0l187N5Mr_CVTUN5Irk9XDtBj8uCG9trE-lnal3zlVlmegdtYHe1asMYFV8SbKv8vbaBulPFa0PBiY_ZcsuKwDwIeOTJTxP7ffoDRXmrST2I3Ktsvhdiru5A3e1pv_kcYZvYkrSzvpOHmBjT9Dubdgp_FL4d9ZdPpESywbgO42VLZKYfS8Xchyg90LWMq5huR98i5sEu7O9EXySiE067risd27thy2rLoM3TJdyfYR23Rz1mZ1V0t5OG-wSGAzzMAwmavI78J1ceQ-yNmRcSIEOkLM15X9iadqKvwQ0p3kCjaxLfD2lRmSwPSFQwet3tlC3Yd_P4dM7aoBESGlwCTJ5ewM0Rj_yUrL8buKmV2UlKKDKKu5QTChMtItZJMramDOyg9G7J0BBWqjxNWF0-qO96GZj9488GYzUjb6cPYLdK--9KLTfULxgx_FFVhUlNzJ4jr78CEtjlk_5bLznjiJj5hShYEudlFMRSnEgfqL6bH5SgHbWEsVnHsCn49UXxZT6F5kY6fSDOY0ZbRczwDAv9xCk9mM7Mw7yqqjOLGjuxmkyB-tXbsyXlOjBDSZFP6NCaVIFVr7GLFB7qcKIKHfbKnAI_AFwpUI_zOTHmfLF2E84bFxkkwFU9mb0mT3uDkpHgA2r9wRIyZptClzSI37NQ6dmUMv5CS1u7obL_8ELf8h52KEtQpEeo9_npGQlfURDEMmIkR8PWGPtWpujnM-sI2IWB7te7wWfihJgONCpJKeHT2BIf-3LLF9XsQ7Flq-vxkxe1XTPLIyMGrxIYtbiO4DiOhW2zk-VLHPVIx55g.v3PC-ixzziRc2hjbTqhzfqZSYiqO-TcQwQow4JA6Wz4=</keystore>
                            <type>rsa</type>
                        </client-certificate>
                    </client-truststore>
                </ssl>
            </crypto>
    </facilities>
</config>