<config xmlns="http://tail-f.com/ns/config/1.0">
    <profiles xmlns="https://curity.se/ns/conf/base">
        <profile>
            <id>token-service</id>
            <type xmlns:as="https://curity.se/ns/conf/profile/oauth">as:oauth-service</type>
            <expose-detailed-error-messages/>
            <settings>
                <authorization-server xmlns="https://curity.se/ns/conf/profile/oauth">
                    <client-capabilities>
                        <assertion>
                            <asymmetrically-signed-jwt>
                                <signature-algorithm>PS256</signature-algorithm>
                            </asymmetrically-signed-jwt>
                        </assertion>
                    </client-capabilities>
                    <client-store>
                        <config-backed>
                            <client>
                                <id>web-client</id>
                                <secret>$5$aRyvWOXJmR77784D$UrcVpbw69xzLVA4/rwj66nkcMT2paCNhXlI3ElLRbTD</secret>
                                <redirect-uris>oauth.tools://app/callback/code</redirect-uris>
                                <user-authentication>
                                </user-authentication>
                                <scope>openid</scope>
                                <scope>profile</scope>
                                <capabilities>
                                <code>
                                </code>
                                </capabilities>
                                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
                            </client>
                            <client>
                                <id>web-pkce-client</id>
                                <no-authentication>true</no-authentication>
                                <redirect-uris>https://oauth.tools/callback/code</redirect-uris>
                                <user-consent>
                                </user-consent>
                                <proof-key>
                                <require-proof-key>true</require-proof-key>
                                </proof-key>
                                <access-token-ttl>1800</access-token-ttl>
                                <refresh-token-ttl>3600</refresh-token-ttl>
                                <id-token-ttl>3600</id-token-ttl>
                                <scope>openid</scope>
                                <scope>profile</scope>
                                <user-authentication>
                                <allowed-authenticators>username</allowed-authenticators>
                                </user-authentication>
                                <capabilities>
                                <code>
                                </code>
                                </capabilities>
                                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
                                <properties>
                                <property>
                                    <key>property1</key>
                                    <value>value1</value>
                                </property>
                                <property>
                                    <key>property2</key>
                                    <value>value2</value>
                                </property>
                                </properties>
                            </client>
                            <client>
                                <id>haapi-android-client</id>
                                <client-name>Haapi Android Client</client-name>
                                <no-authentication>true</no-authentication>
                                <redirect-uris>app://haapi</redirect-uris>
                                <audience>haapi-client</audience>
                                <scope>address</scope>
                                <scope>email</scope>
                                <scope>openid</scope>
                                <scope>phone</scope>
                                <scope>profile</scope>
                                <capabilities>
                                    <code/>
                                    <haapi/>
                                </capabilities>
                                <attestation>
                                    <android>
                                        <package-name>io.curity.haapidemo</package-name>
                                        <signature-digest>Z2DKEZO2XWFWQnApoRCzhqhIxzODe7BUsArj4Up9oKQ=</signature-digest>
                                        <android-policy>android-dev-policy</android-policy>
                                    </android>
                                </attestation>
                            </client>
                            <client>
                                <id>haapi-ios-client</id>
                                <client-name>Haapi iOS Client</client-name>
                                <no-authentication>true</no-authentication>
                                <redirect-uris>haapi:start</redirect-uris>
                                <user-authentication>
                                </user-authentication>
                                <scope>address</scope>
                                <scope>email</scope>
                                <scope>openid</scope>
                                <scope>phone</scope>
                                <scope>profile</scope>
                                <capabilities>
                                <code/>
                                <haapi/>
                                </capabilities>
                                <attestation>
                                <disable-attestation-validation>true</disable-attestation-validation>
                                <ios>
                                    <app-id>io.curity.cat.ios.client</app-id>
                                    <ios-policy>ios-dev-policy</ios-policy>
                                </ios>
                                </attestation>
                            </client>
                            <client>
                                <id>token-exchange-client</id>
                                <secret>$5$Mh4wCzhNzpIeAaiC$OGcoepRMuRrpp5CT36W5tUAXTfVUdBVujYkfDBzblJB</secret>
                                <capabilities>
                                <token-exchange/>
                                </capabilities>
                            </client>
                            <client>
                                <id>unsupported-assertion-client</id>
                                <jwks-uri>
                                    <uri>https://api.example.com/jwks</uri>
                                </jwks-uri>
                                <capabilities>
                                <assertion>
                                    <jwt>
                                    <trust>
                                        <asymmetric-signing-key>default-signature-verification-key</asymmetric-signing-key>
                                    </trust>
                                    </jwt>
                                </assertion>
                                </capabilities>
                            </client>
                        </config-backed>
                    </client-store>
                </authorization-server>
            </settings>
        </profile>
    </profiles>
    <facilities xmlns="https://curity.se/ns/conf/base">
        <client-attestation>
            <ios-policy xmlns="https://curity.se/ns/conf/client-attestation">
                <id>ios-dev-policy</id>
                <mode>non-production</mode>
            </ios-policy>
            <android-policy xmlns="https://curity.se/ns/conf/client-attestation">
                <id>android-dev-policy</id>
                <verify-boot-state>false</verify-boot-state>
                <minimum-security-level>software</minimum-security-level>
                <override-certificate-chain-validation>
                    <do-not-validate-certificate-chain/>
                </override-certificate-chain-validation>
            </android-policy>
        </client-attestation>
    </facilities>
</config>